<div class="space-y-6">
  <div class="animate-slide-in-left flex items-center justify-between">
    <div>
      <h1 class="font-display text-text-primary text-2xl font-bold">
        {{ isEditing() ? 'Edit Entry' : 'New Entry' }}
      </h1>
      <p class="text-text-secondary mt-1">{{ isEditing() ? 'Update this changelog entry.' : 'Create a new changelog entry with markdown preview.' }}</p>
    </div>
    <a routerLink="/admin/changelogs">
      <lfx-button variant="ghost">
        <i class="fa-solid fa-arrow-left text-xs"></i>
        Back
      </lfx-button>
    </a>
  </div>

  <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
    <!-- Form -->
    <div class="animate-slide-in-left relative z-10 space-y-5 [animation-delay:150ms]">
      <lfx-input label="Title" placeholder="Enter entry title..." [formControl]="titleControl" />

      <lfx-select label="Product" [options]="productOptions()" [formControl]="productIdControl" placeholder="Select product..." />

      <lfx-input label="Version" placeholder="e.g., 2.5.0" [formControl]="versionControl" />

      <lfx-markdown-editor label="Description" [rows]="12" placeholder="Write markdown content..." [formControl]="descriptionControl" />

      <div class="flex gap-3 pt-2">
        <lfx-button variant="primary" [loading]="saving()" (clicked)="save()">
          {{ isEditing() ? 'Update Entry' : 'Save as Draft' }}
        </lfx-button>
        <a routerLink="/admin/changelogs">
          <lfx-button variant="secondary">Cancel</lfx-button>
        </a>
      </div>
    </div>

    <!-- Live preview -->
    <div class="animate-slide-in-right hidden [animation-delay:200ms] lg:block">
      <div class="sticky top-6 space-y-6">
        <h2 class="text-text-muted text-sm font-medium">
          <i class="fa-duotone fa-eye mr-1"></i>
          Live Preview
        </h2>

        <!-- Card Preview -->
        <div class="space-y-2">
          <h3 class="text-text-muted text-xs font-medium tracking-wider uppercase">Card View</h3>
          <lfx-changelog-card [entry]="previewEntry()" />
        </div>

        <!-- Detail Page Preview -->
        <div class="space-y-2">
          <h3 class="text-text-muted text-xs font-medium tracking-wider uppercase">Detail View</h3>
          <lfx-card>
            <div class="space-y-5">
              <!-- Header row: version + status -->
              <div class="flex flex-wrap items-center gap-2">
                @if (previewEntry().version) {
                  <span class="text-text-muted text-xs font-medium">v{{ previewEntry().version }}</span>
                }
                <lfx-status-badge [status]="previewEntry().status" />
              </div>

              <!-- Title -->
              <h3 class="font-display text-text-primary text-xl font-bold">{{ previewEntry().title }}</h3>

              <!-- Metadata sidebar (inline for preview) -->
              <div class="border-border bg-surface-alt flex flex-wrap items-center gap-4 rounded-lg border px-4 py-3">
                @if (selectedProduct(); as prod) {
                  <div class="flex items-center gap-2">
                    <span class="text-text-muted text-xs font-medium uppercase">Product</span>
                    <lfx-product-pill [product]="prod" />
                  </div>
                }
                @if (previewEntry().version) {
                  <div class="flex items-center gap-2">
                    <span class="text-text-muted text-xs font-medium uppercase">Version</span>
                    <span class="text-text-primary text-sm font-medium">v{{ previewEntry().version }}</span>
                  </div>
                }
                <div class="flex items-center gap-2">
                  <span class="text-text-muted text-xs font-medium uppercase">Status</span>
                  <span class="text-text-secondary text-sm">Draft</span>
                </div>
              </div>

              <!-- Markdown content -->
              @if (descriptionValue()) {
                <div class="border-border border-t pt-4">
                  <lfx-markdown-renderer [content]="descriptionValue()" />
                </div>
              } @else {
                <p class="text-text-muted py-6 text-center text-sm">Start typing a description to see the rendered preview.</p>
              }
            </div>
          </lfx-card>
        </div>
      </div>
    </div>
  </div>
</div>
