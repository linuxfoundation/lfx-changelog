<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<div class="space-y-6">
  <div class="animate-slide-in-left flex items-center justify-between">
    <div>
      <h1 data-testid="product-management-heading" class="font-display text-text-primary text-2xl font-bold">Products</h1>
      <p class="text-text-secondary mt-1">Manage LFX products for changelog categorization.</p>
    </div>
    <lfx-button data-testid="product-management-add-btn" variant="primary" (clicked)="openAdd()">
      <i class="fa-solid fa-plus text-xs"></i>
      Add Product
    </lfx-button>
  </div>

  <lfx-table class="animate-rise-in block [animation-delay:150ms]" [data]="products()" [loading]="loading()" testId="product-management-table">
    <ng-template lfxColumn="Name" let-product>
      <a [routerLink]="['/admin/products', product.id]" class="flex items-center gap-2.5 hover:opacity-80">
        @if (product.faIcon) {
          <i [class]="product.faIcon" class="text-brand-600"></i>
        }
        <span class="text-text-primary text-sm font-medium hover:underline">{{ product.name }}</span>
      </a>
    </ng-template>

    <ng-template lfxColumn="Slug" let-product>
      <span class="text-text-secondary font-mono text-sm">{{ product.slug }}</span>
    </ng-template>

    <ng-template lfxColumn="Description" let-product>
      <span class="text-text-secondary max-w-xs truncate text-sm">{{ product.description || 'â€”' }}</span>
    </ng-template>

    <ng-template lfxColumn="Actions" let-product>
      <lfx-button data-testid="product-management-edit-btn" variant="ghost" size="sm" (clicked)="openEdit(product)">Edit</lfx-button>
    </ng-template>
  </lfx-table>
</div>

<lfx-dialog data-testid="product-dialog" [(visible)]="dialogVisible" [title]="editingProduct() ? 'Edit Product' : 'Add Product'">
  <div class="space-y-4">
    <lfx-input data-testid="product-dialog-name-input" label="Name" placeholder="Product name..." [formControl]="formNameControl" />
    <lfx-input data-testid="product-dialog-slug-input" label="Slug" placeholder="product-slug" [formControl]="formSlugControl" />
    <lfx-textarea
      data-testid="product-dialog-description-input"
      label="Description"
      [rows]="3"
      placeholder="Product description..."
      [formControl]="formDescriptionControl" />
    <div class="flex justify-end gap-3 pt-2">
      <lfx-button variant="secondary" (clicked)="dialogVisible.set(false)">Cancel</lfx-button>
      <lfx-button data-testid="product-dialog-save-btn" variant="primary" [loading]="saving()" (clicked)="saveProduct()">
        {{ editingProduct() ? 'Update' : 'Create' }}
      </lfx-button>
    </div>
  </div>
</lfx-dialog>
